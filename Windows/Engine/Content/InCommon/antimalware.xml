<?xml version="1.0" encoding="utf-8" ?>
<Content xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://incert.incommon.org/schemas ../Schemas/tasklist.xsd">
  <Branches>
    <TaskBranch name="antimalware.evaluate">
      <Control.ReturnBranchResult>
        <Conditions.Any>
          <Control.SecondsHaveNotElapsed key="Last malware scan" value="86400" />
        </Conditions.Any>
        <Properties>
          <Branch>antimalware.skip</Branch>
        </Properties>
      </Control.ReturnBranchResult>

      <Control.ReturnBranchResult>
        <Conditions.Any>
          <Control.SecondsHaveElapsed key="Last malware scan" value="86400" />
        </Conditions.Any>
        <Properties>
          <Branch>antimalware.scan</Branch>
        </Properties>
      </Control.ReturnBranchResult>
    </TaskBranch>
    
    <TaskBranch name="antimalware.scan">
      <UserInterface.ActivateCheckedParagraph minimumTaskTime="1">
        <Properties>
          <Dialog>Main dialog</Dialog>
          <ControlKey>Scanning computer for malware</ControlKey>
        </Properties>
      </UserInterface.ActivateCheckedParagraph>

      <UserInterface.SetCheckedParagraphSubtitle>
        <Properties>
          <Dialog>Main dialog</Dialog>
          <ControlKey>Scanning computer for malware</ControlKey>
        </Properties>
        <Content>
          <ProgressParagraph settingKey="Scanning computer for malware subtitle" margin="0,0,0,0" padding="0,0,0,0" style="InsetText">
            <Content>
              <DirectTextContent>Downloading Microsoft Malicious Software Removal Tool</DirectTextContent>
            </Content>
          </ProgressParagraph>
        </Content>
      </UserInterface.SetCheckedParagraphSubtitle>

      <UserInterface.StartMessageTimer forwardOnly="true">
        <Properties>
          <SettingKey>Scanning computer for malware subtitle</SettingKey>
        </Properties>
      </UserInterface.StartMessageTimer>

      <Control.ReturnBranchResult errorBranch="generic download error branch" minimumTaskTime="3">
        <Properties>
          <Branch>antimalware.download malicious software removal tool</Branch>
        </Properties>
      </Control.ReturnBranchResult>

      <UserInterface.StopMessageTimer>
        <Properties>
          <SettingKey>Scanning computer for malware subtitle</SettingKey>
        </Properties>
      </UserInterface.StopMessageTimer>

      <UserInterface.SetCheckedParagraphSubtitle>
        <Properties>
          <Dialog>Main dialog</Dialog>
          <ControlKey>Scanning computer for malware</ControlKey>
        </Properties>
        <Content>
          <ProgressParagraph settingKey="Scanning computer for malware subtitle" margin="0,0,0,0" padding="0,0,0,0" style="InsetText">
            <Content>
              <DirectTextContent>Please wait while !ApplicationTitle! scans your computer for viruses, trojans, or other types of malicious software</DirectTextContent>
            </Content>
          </ProgressParagraph>
        </Content>
      </UserInterface.SetCheckedParagraphSubtitle>

      <UserInterface.StartMessageTimer>
        <Properties>
          <SettingKey>Scanning computer for malware subtitle</SettingKey>
        </Properties>
      </UserInterface.StartMessageTimer>

      <UserInterface.DisableCloseButton>
        <Properties>
          <Dialog>Main dialog</Dialog>
        </Properties>
      </UserInterface.DisableCloseButton>

      <AntiMalware.ScanComputerForMalware>
        <Properties>
          <ScannerPath>[msscanner target]</ScannerPath>
          <Interactive>false</Interactive>
        </Properties>
      </AntiMalware.ScanComputerForMalware>

      <UserInterface.EnableCloseButton>
        <Properties>
          <Dialog>Main dialog</Dialog>
        </Properties>
      </UserInterface.EnableCloseButton>

      <UserInterface.StopMessageTimer>
        <Properties>
          <SettingKey>Scanning computer for malware subtitle</SettingKey>
        </Properties>
      </UserInterface.StopMessageTimer>

      <UserInterface.RemoveCheckedParagraphSubtitle>
        <Properties>
          <Dialog>Main dialog</Dialog>
          <ControlKey>Scanning computer for malware</ControlKey>
        </Properties>
      </UserInterface.RemoveCheckedParagraphSubtitle>

      <UserInterface.CompleteCheckedParagraph minimumTaskTime="1">
        <Properties>
          <Dialog>Main dialog</Dialog>
          <ControlKey>Scanning computer for malware</ControlKey>
        </Properties>
      </UserInterface.CompleteCheckedParagraph>

      <Settings.PersistSettingsTimestamp>
        <Properties>
          <SettingKey>Last malware scan</SettingKey>
        </Properties>
      </Settings.PersistSettingsTimestamp>
    </TaskBranch>

    <TaskBranch name="antimalware.download malicious software removal tool">
      <Settings.SetSettingText>
        <Conditions.Any>
          <SystemInfo.Is64Bit />
        </Conditions.Any>

        <Properties>
          <Setter key="show generic download banner">false</Setter>
          <Setter key="generic download branch info key">msscanner64.info.xml</Setter>
          <Setter key="generic download branch target url">msscanner64.info.xml</Setter>
          <Setter key="generic download branch display name">Malicious Software Removal Tool</Setter>
          <Setter key="msscanner target">MSScanner64.exe</Setter>
        </Properties>
      </Settings.SetSettingText>

      <Settings.SetSettingText>
        <Conditions.Any>
          <SystemInfo.IsNot64Bit />
        </Conditions.Any>

        <Properties>
          <Setter key="show generic download banner">false</Setter>
          <Setter key="generic download branch info key">msscanner32.info.xml</Setter>
          <Setter key="generic download branch target url">msscanner32.info.xml</Setter>
          <Setter key="generic download branch display name">Malicious Software Removal Tool</Setter>
          <Setter key="msscanner target">MSScanner32.exe</Setter>
        </Properties>
      </Settings.SetSettingText>

      <Control.ReturnBranchResult>
        <Properties>
          <Branch>generic download branch</Branch>
        </Properties>
      </Control.ReturnBranchResult>

      <Control.ReturnBranchResult>
        <Properties>
          <Branch>generic download branch</Branch>
        </Properties>
      </Control.ReturnBranchResult>
    </TaskBranch>


    <TaskBranch name="antimalware.skip">
      <UserInterface.SetCheckedParagraphSubtitle>
        <Properties>
          <Dialog>Main dialog</Dialog>
          <ControlKey>Scanning computer for malware</ControlKey>
        </Properties>
        <Content>
          <SimpleParagraph style="InsetText" margin="0,0,0,0" padding="0,0,0,0">
            <Content>
              <DirectTextContent>A malicious software scan has been recently completed on this computer.</DirectTextContent>
            </Content>
          </SimpleParagraph>
        </Content>
      </UserInterface.SetCheckedParagraphSubtitle>
    </TaskBranch>
  </Branches>
</Content>