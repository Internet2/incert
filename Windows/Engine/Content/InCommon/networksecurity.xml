<?xml version="1.0" encoding="utf-8" ?>
<Content xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://incert.incommon.org/schemas ../Schemas/tasklist.xsd">
  <Branches>
    <TaskBranch name="networksecurity.configure">
      <Control.ReturnBranchResult>
        <Properties>
          <Branch>networksecurity.configure firewall</Branch>
        </Properties>
      </Control.ReturnBranchResult>
      <Control.ReturnBranchResult minimumTaskTime="3">
        <Properties>
          <Branch>networksecurity.block ports</Branch>
        </Properties>
      </Control.ReturnBranchResult>
    </TaskBranch>

    <TaskBranch name="networksecurity.configure firewall">
      <Control.ReturnLeaveBranchNextResult>
        <Conditions.All>
          <Firewall.IsFirewallEnabled profile="All" />
        </Conditions.All>
      </Control.ReturnLeaveBranchNextResult>

      <Firewall.EnableFirewall minimumTaskTime="3">
        <Properties>
          <Profile>All</Profile>
        </Properties>
      </Firewall.EnableFirewall>
    </TaskBranch>

    <TaskBranch name="networksecurity.block ports">
      <Firewall.AddRule>
        <Properties>
          <Action>NET_FW_ACTION_BLOCK</Action>
          <Description>!ApplicationTitle! block UDP 135 rule</Description>
          <Enabled>true</Enabled>
          <Grouping>!ApplicationTitle!</Grouping>
          <LocalPorts>135</LocalPorts>
          <Name>Block Port UDP 135 (!ApplicationTitle!)</Name>
          <Profile>All</Profile>
          <Protocol>NET_FW_IP_PROTOCOL_UDP</Protocol>
        </Properties>
      </Firewall.AddRule>

      <Firewall.AddRule>
        <Properties>
          <Action>NET_FW_ACTION_BLOCK</Action>
          <Description>!ApplicationTitle! block TCP 135 rule</Description>
          <Enabled>true</Enabled>
          <Grouping>!ApplicationTitle!</Grouping>
          <LocalPorts>135</LocalPorts>
          <Name>Block Port TCP 135 (!ApplicationTitle!)</Name>
          <Profile>All</Profile>
          <Protocol>NET_FW_IP_PROTOCOL_TCP</Protocol>
        </Properties>
      </Firewall.AddRule>

      <Firewall.AddRule>
        <Properties>
          <Action>NET_FW_ACTION_BLOCK</Action>
          <Description>!ApplicationTitle! block TCP 593 rule</Description>
          <Enabled>true</Enabled>
          <Grouping>!ApplicationTitle!</Grouping>
          <LocalPorts>135</LocalPorts>
          <Name>Block Port TCP 593 (!ApplicationTitle!)</Name>
          <Profile>All</Profile>
          <Protocol>NET_FW_IP_PROTOCOL_TCP</Protocol>
        </Properties>
      </Firewall.AddRule>
    </TaskBranch>
  </Branches>
</Content>